
impl<error E, T> E | T {
    func orDefault(self, value) {
        match self {
            E -> value
            T -> self
        }
    }

    func unwrap(self, message) {
        match self {
            E -> std.panic(message)
            T -> self
        }
    }

    inline func map(self, closure) {
        match self {
            E -> self
            T -> closure(T)
        }
    }

    inline func mapError(self, closure) {
        match self {
            E -> closure(self)
            T -> self
        }
    }
}

impl<T> T | null {
    func orDefault(self, value) {
        match self {
            null -> value
            _ -> self
        }
    }

    inline func map(self, closure) {
        match self {
            null -> null
            T -> closure(self)
        }
    }

    func unwrap(self, message) {
        match self {
            null -> std.panic(message)
            T -> self
        }
    }
}


error struct ConversionError {
    src str,
    target str
}

impl ConversionError {
    func new(src, target) {
        ConversionError(src, target)
    }
}